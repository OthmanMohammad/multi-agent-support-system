# =============================================================================
# ENVIRONMENT CONFIGURATION EXAMPLE
# =============================================================================
#
# üîê DOPPLER SECRETS MANAGEMENT
# This project uses Doppler for secure secret management.
#
# This .env.example file is for reference only.
# For local development without Doppler, copy this to .env and fill in values.
#
# =============================================================================

# -----------------------------------------------------------------------------
# Environment (REQUIRED)
# -----------------------------------------------------------------------------
ENVIRONMENT=staging        # staging, production

# -----------------------------------------------------------------------------
# CORS Configuration (REQUIRED)
# -----------------------------------------------------------------------------
# IMPORTANT: Must be in JSON array format with double quotes
# NO WILDCARDS ALLOWED for security
#
# Example for staging (local development) (must be JSON array format):
API_CORS_ORIGINS=["http://localhost:3000","http://127.0.0.1:3000","http://localhost:8000"]
#
# Example for staging server:
# API_CORS_ORIGINS=["https://staging.yourdomain.com","https://staging-api.yourdomain.com"]
#
# Example for production:
# API_CORS_ORIGINS=["https://app.yourdomain.com","https://api.yourdomain.com"]

# -----------------------------------------------------------------------------
# Database Configuration (REQUIRED)
# -----------------------------------------------------------------------------
# Format: postgresql+asyncpg://user:password@host:port/database
#
# Example for staging (local):
DATABASE_URL=postgresql+asyncpg://postgres:your_password@localhost:5432/support_agent
#
# Example for staging server:
# DATABASE_URL=postgresql+asyncpg://staging_user:staging_password@staging-db.yourdomain.com:5432/support_agent_staging
#
# Example for production:
# DATABASE_URL=postgresql+asyncpg://prod_user:prod_password@prod-db.yourdomain.com:5432/support_agent

# -----------------------------------------------------------------------------
# Anthropic API (REQUIRED)
# -----------------------------------------------------------------------------
ANTHROPIC_API_KEY=sk-ant-your-key-here

# -----------------------------------------------------------------------------
# Qdrant Vector Store (REQUIRED)
# -----------------------------------------------------------------------------
QDRANT_URL=https://your-cluster.cloud.qdrant.io:6333
QDRANT_API_KEY=your-qdrant-api-key

# -----------------------------------------------------------------------------
# Logging Configuration
# -----------------------------------------------------------------------------
LOG_LEVEL=INFO                    # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json                   # json (recommended) or pretty (for local debugging)
LOG_CORRELATION_ID=true
LOG_MASK_PII=true
LOG_INCLUDE_TIMESTAMP=true

# -----------------------------------------------------------------------------
# Sentry Error Tracking (REQUIRED)
# -----------------------------------------------------------------------------
SENTRY_DSN=https://your-key@your-org.ingest.sentry.io/your-project
SENTRY_ENVIRONMENT=staging        # Should match ENVIRONMENT value
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1

# -----------------------------------------------------------------------------
# Redis Configuration (OPTIONAL - for rate limiting and token blacklist)
# -----------------------------------------------------------------------------
# Set REDIS_ENABLED=false to run without Redis (useful for development)
REDIS_ENABLED=true                              # Set to false to disable Redis
REDIS_URL=redis://localhost:6379/0              # Redis connection URL
# REDIS_PASSWORD=your-redis-password            # Optional Redis password

# Redis Features
REDIS_RATE_LIMIT_ENABLED=true                   # Enable rate limiting (requires REDIS_ENABLED=true)
REDIS_TOKEN_BLACKLIST_ENABLED=true              # Enable token blacklist (requires REDIS_ENABLED=true)

# -----------------------------------------------------------------------------
# JWT Security (REQUIRED - minimum 32 characters)
# -----------------------------------------------------------------------------
JWT_SECRET_KEY=change-this-to-a-long-random-string-min-32-chars

# =============================================================================
# GPU ORCHESTRATION - PHASE 3
# =============================================================================

# -----------------------------------------------------------------------------
# Modal.com Serverless GPU (RECOMMENDED)
# -----------------------------------------------------------------------------
# Modal provides serverless vLLM deployment with automatic GPU scaling.
# No instance management required - Modal handles everything automatically.
#
# Setup:
# 1. Create account: https://modal.com
# 2. Install CLI: pip install modal
# 3. Authenticate: modal setup
# 4. Deploy vLLM: modal deploy src/vllm/modal_vllm.py
# 5. Copy the web URL here
#
# Documentation: docs/MODAL_SETUP.md

# Modal Web URL (REQUIRED for Modal provider)
# This is the URL from your Modal deployment output
# Example: https://yourorg--modal-vllm-serve.modal.run
MODAL_WEB_URL=https://yourorg--modal-vllm-serve.modal.run

# Modal API Tokens (OPTIONAL - only needed for programmatic deployment)
# Get from: https://modal.com/settings/tokens
# MODAL_TOKEN_ID=ak-xxxxxxxxxxxxxxx
# MODAL_TOKEN_SECRET=as-xxxxxxxxxxxxxxx

# vLLM Model Configuration
MODAL_MODEL=Qwen/Qwen2.5-7B-Instruct
MODAL_GPU_TYPE=L4                             # Options: L4 ($0.80/hr), A100 ($3/hr), H100 ($4.50/hr), A10G ($1/hr)
MODAL_SCALEDOWN_WINDOW_MINUTES=5             # Keep GPU warm for 5 min after last request

# Health Check Settings
MODAL_HEALTH_CHECK_TIMEOUT_SECONDS=30
MODAL_STARTUP_TIMEOUT_MINUTES=10
MODAL_MAX_RETRIES=3
MODAL_REQUEST_TIMEOUT_SECONDS=120

# -----------------------------------------------------------------------------
# Vast.ai GPU (LEGACY - NOT RECOMMENDED)
# -----------------------------------------------------------------------------
# Vast.ai requires manual instance management and has reliability issues.
# We migrated to Modal due to persistent CDI infrastructure errors.
#
# If you still want to use Vast.ai, uncomment these settings:
# (Note: Modal takes priority if both are configured)

# Vast.ai API Key (OPTIONAL - only if using Vast.ai instead of Modal)
# VASTAI_API_KEY=your-vastai-api-key

# Budget Management
# VASTAI_BUDGET_LIMIT=15.0                     # Maximum budget in USD
# VASTAI_SESSION_BUDGET_LIMIT=2.0             # Maximum per-session budget

# GPU Instance Settings
# VASTAI_DEFAULT_KEEP_ALIVE_MINUTES=45
# VASTAI_MAX_STARTUP_TIME_MINUTES=10

# vLLM Configuration
# VASTAI_VLLM_MODEL=Qwen/Qwen2.5-7B-Instruct
# VASTAI_VLLM_GPU_MEMORY_UTILIZATION=0.95
# VASTAI_VLLM_MAX_MODEL_LEN=4096

# =============================================================================
# END GPU ORCHESTRATION
# =============================================================================
